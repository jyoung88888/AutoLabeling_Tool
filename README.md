# 🚀 자동라벨링 프로그램 (AutoLabeling)

> **Vue.js + FastAPI 기반 YOLO 자동라벨링 시스템**  
> 이미지 객체 탐지 및 라벨링 자동화 도구  
> 🔥 **시스템 안정성 및 코드 품질 대폭 개선** - 최적화된 성능과 향상된 신뢰성

![image](https://github.com/user-attachments/assets/8dedfe9e-e7b0-45c3-9e23-f04ecc12b973)

## 🏗️ **시스템 아키텍처**
![이미지 자동 라벨링 설계](https://github.com/user-attachments/assets/9a777234-9e77-4539-908d-c1b4926a10a6)

## 📋 목차

- [✨ 주요 기능](#-주요-기능)
- [🚀 최신 개선사항](#-최신-개선사항)
- [🛠️ 기술 스택](#️-기술-스택)
- [⚡ 빠른 시작](#-빠른-시작)
- [📁 프로젝트 구조](#-프로젝트-구조)
- [🔧 환경 설정](#-환경-설정)
- [⌨️ 키보드 단축키](#️-키보드-단축키)
- [📖 API 문서](#-api-문서)
- [💾 프로젝트 저장 형식](#-프로젝트-저장-형식)
- [🔍 트러블슈팅](#-트러블슈팅)
- [🎯 사용법](#-사용법)
- [🤝 기여하기](#-기여하기)

## ✨ 주요 기능

### 🎯 자동 라벨링
- **YOLO 모델 기반** 실시간 객체 탐지
- **다중 클래스 선택** 지원
- **사용자 맞춤 신뢰도 설정**: 사이드바에서 설정한 신뢰도 값이 정확히 모델에 적용
- **최적화된 NMS 설정**: IoU 임계값 0.5로 중복 제거 성능 최적화
- **산업 안전 장비 검출 개선**: hoist, helmet 등 안전 장비 검출 정확도 향상
- **저해상도 이미지 자동 최적화**: 낮은 해상도 이미지 자동 리사이즈로 검출 성능 향상
- **저신뢰도 이미지 자동 감지** (신뢰도 < 50%)
- **상세한 처리 로그**: 각 단계별 성공/실패 로그로 투명한 처리 과정 제공

### 🖼️ 이미지 관리
- **다중 이미지 업로드** (Drag & Drop 지원)
- **실시간 이미지 프리뷰**
- **자동 이미지 포맷 변환**
- **메모리 최적화**: 효율적인 메모리 기반 이미지 처리
- **클래스 범례 표시**: 이미지 뷰어에 클래스 ID, 이름, 색상 정보 실시간 표시

### ✏️ 라벨 편집
- **🔥 바운딩 박스 편집 안정성 대폭 개선** - 저장 좌표 정확성 보장
- **Konva 기반 인터랙티브 편집**: 부드러운 바운딩 박스 편집 (이동, 크기 조정, 삭제)
- **키보드 단축키 지원**:
  - **E키**: 편집 모드 활성화/비활성화
  - **B키**: 바운딩 박스 그리기 모드
  - **Ctrl+C/V**: 바운딩 박스 복사/붙여넣기  
  - **Ctrl+Z**: 작업 되돌리기 (최대 10단계)
  - **H키**: 바운딩 박스 숨김/표시
  - **G키**: 숨겨진 박스 모두 표시
  - **T키**: 바운딩 박스 굵기 토글
  - **Space+드래그**: 이미지 위치 이동
- **다중 선택**: Shift+클릭으로 여러 바운딩 박스 선택
- **향상된 UI**: 밝은 색상, 그림자 효과로 가시성 향상

### 💾 프로젝트 관리
- **프로젝트 저장/불러오기**
- **YOLO 형식 완전 호환 내보내기**
- **클래스 정보 완전 저장**: 모델의 모든 클래스 정보 저장
- **프로젝트 구조 자동 생성**
- **파일 삭제 기능**: DELETE키로 불필요한 이미지 및 라벨 파일 안전 삭제
- **프로젝트 정보 무결성**: 클래스 ID와 이름 매핑 완벽 보장

### 🔄 실시간 UI
- **Vue.js 3 기반 반응형 인터페이스**
- **Vuetify 3 Material Design UI**
- **다크 테마 지원**
- **실시간 진행률 표시**
- **프로그레스 바 네비게이션**: 상단 프로그레스 바 클릭/드래그로 직관적인 이미지 이동
- **완전 랜덤 색상 시스템**: 이미지/프로젝트 변경 시마다 새로운 랜덤 색상 배정

### 🔍 품질 관리
- **저신뢰도 이미지 자동 감지** 및 목록 표시
- **클래스별 신뢰도 표시**
- **신뢰도 백분율 표시**

## 🚀 최신 개선사항

### 🔧 시스템 안정성 개선
- **백엔드 코드 최적화**: 사용되지 않는 변수, 함수, 라이브러리 제거
- **메모리 관리 최적화**: 효율적인 메모리 사용 및 자동 정리 시스템
- **타입 안전성 강화**: Linter 오류 완전 해결로 런타임 안정성 향상
- **모델 상태 검증 강화**: YOLO 모델 로드 상태 사전 검증 시스템

### 📊 코드 품질 향상
- **Import 최적화**: 필요한 라이브러리만 로드하여 시작 시간 단축
- **함수 중복 제거**: 중복된 기능을 통합하여 코드 일관성 향상
- **에러 처리 개선**: 더 정확한 에러 메시지와 예외 처리
- **코드 구조 개선**: 더 명확한 함수 역할 분리 및 모듈화

### ⚡ 성능 최적화
- **메서드 호출 최적화**: 불필요한 메서드 호출 제거
- **클래스 정보 처리 개선**: 모델 클래스 정보 매핑 정확성 향상
- **프로젝트 로드 속도 개선**: 프로젝트 파일 처리 로직 최적화
- **정규표현식 최적화**: 파일 패턴 매칭 성능 향상

### 🛡️ 보안 및 안정성
- **파일 경로 검증 강화**: 경로 보안 검사 개선
- **입력 데이터 검증**: 모든 사용자 입력에 대한 엄격한 검증
- **메모리 누수 방지**: 자동 메모리 정리 시스템 강화
- **예외 상황 처리**: 예상치 못한 오류에 대한 복구 메커니즘

### 🎯 YOLO 모델 최적화 및 검출 성능 개선
- **YOLO 모델 파라미터 최적화**: 객체 검출 성능 대폭 개선
  - **사용자 신뢰도 설정 완전 적용**: 사이드바에서 설정한 신뢰도 값이 정확히 모델에 반영
  - **IoU 임계값 최적화**: NMS IoU 기본값을 0.5로 설정하여 최적의 중복 제거 성능 제공
  - **ultralytics 표준 파라미터 적용**: 검증된 기본값들로 안정적인 예측 성능 보장
- **hoist와 helmet 검출 성능 개선**: 산업 안전 장비 검출 정확도 향상
  - 기존에 놓쳤던 hoist, helmet 등의 객체들을 더 정확하게 감지
  - 신뢰도 임계값 유연성으로 사용자 요구에 맞는 검출 수준 조정 가능
- **예외 처리 및 로깅 시스템 개선**: 400 Bad Request 오류 해결
  - `/labeling/process` 엔드포인트 상세 로깅 추가로 오류 진단 개선
  - 각 처리 단계별 성공/실패 로그 기록으로 디버깅 효율성 향상
  - 모델 예측 과정의 투명성 증대

### 🛠️ 시스템 안정성 강화 및 코드 품질 개선
- **DELETE 요청 지원**: HTTP DELETE 요청 프록시 기능 추가로 파일 삭제 안정성 향상
- **Linter 오류 완전 해결**: 모든 Python 파일에서 타입 검증 및 런타임 안정성 강화
- **서버 핸들러 개선**: SPAHandler 클래스에 DELETE 메소드 추가로 API 완전 호환성 확보
- **코드 정리 및 최적화**: 사용하지 않는 변수 제거, 예외 처리 개선, import 최적화
- **경로 설정 개선**: 서버 경로 설정 정확성 및 안정성 향상

### 📋 바운딩박스 편집 기능 완전 개선
- **바운딩박스 복사/붙여넣기 기능 개선**: Ctrl+V 바운딩박스 붙여넣기 기능 완전 수정
  - 복사된 박스가 없을 때 명확한 알림 메시지 표시
  - 이미지 경계를 넘어서는 바운딩박스 자동 크기 조정
  - 단일, 다중, 전체 복사 모든 경우에서 붙여넣기 정상 동작
- **이미지 간 이동 시 데이터 유지**: 복사된 바운딩박스 데이터가 이미지 변경 시에도 유지
  - `copiedBox` 상태를 MainView에서 전역 관리
  - 프로젝트 전체에서 일관된 복사/붙여넣기 동작
- **바운딩박스 굵기 설정 유지**: T키로 설정한 바운딩박스 굵기가 이미지 변경 시에도 유지
  - `thickBoxMode` 상태를 MainView에서 전역 관리
  - 프로젝트 전체에서 일관된 시각적 표시

### 🎨 클래스 범례 시스템 및 UI/UX 개선
- **클래스 범례 표시 기능 추가**: 이미지 뷰어에 클래스 정보 범례 실시간 표시
  - 프로젝트 class_info 기반 동적 클래스 정보 표시
  - 클래스 ID, 이름, 색상 인디케이터 포함
  - 이미지 뷰어 좌측 상단에 플로팅 형태로 배치
  - 반투명 배경과 모던한 UI 디자인
  - 스크롤 가능한 범례 목록으로 많은 클래스도 지원
  - 호버 효과와 부드러운 애니메이션 적용
- **UI/UX 개선**: 신뢰도 설정 슬라이더 thumb 크기 최적화
  - 슬라이더 조절 핸들 크기를 12px로 조정하여 더 정밀한 조작 가능
  - 깔끔하고 세련된 UI 디자인 적용

### 🔍 확대/축소 기능 개선
- **마우스 커서 중심 확대/축소**: W/Q 키로 단계적 확대/축소 시 마우스 커서 위치를 중심으로 동작
  - 실시간 마우스 위치 추적으로 정확한 위치 기반 확대/축소
  - 25%에서 1600%까지 14단계 순환 확대/축소 지원
  - 마우스 위치를 알 수 없는 경우 화면 중앙을 기본값으로 사용
  - 직관적이고 정밀한 이미지 탐색 경험 제공

## 🛠️ 기술 스택

### Frontend
- **Vue.js 3.5.13** - 프론트엔드 프레임워크
- **Vuetify 3.8.0** - Material Design UI 라이브러리
- **Konva 9.3.20** - 2D 캔버스 라이브러리 (바운딩 박스 편집)
- **Vue-konva 3.2.1** - Vue.js용 Konva 래퍼
- **Axios 1.8.4** - HTTP 클라이언트
- **Vite 6.2.4** - 빌드 도구 및 개발 서버
- **ESLint 9.22.0** - 코드 품질 도구
- **Prettier 3.5.3** - 코드 포맷터

### Backend
- **FastAPI** - 고성능 Python 웹 프레임워크
- **Uvicorn** - ASGI 서버
- **Python 3.10** - 백엔드 런타임
- **PyTorch** - 딥러닝 프레임워크
- **OpenCV** - 컴퓨터 비전 라이브러리
- **Pillow** - 이미지 처리 라이브러리

## ⚡ 빠른 시작

### 1. 저장소 클론
```bash
git clone <repository-url>
cd autolabeling
```

### 2. 프로그램 실행
Python 서버 실행 시 Vue 웹 인터페이스도 함께 실행됩니다:

```bash
# 개발 모드 (기본값)
python run.py

# 또는 명시적으로 개발 모드 지정
python run.py dev

# 포트 변경
python run.py dev --port 3000

# 의존성 설치 건너뛰기
python run.py dev --no-install
```

#### 🚀 프로덕션 모드 (빌드 모드)
Vue.js를 빌드하여 최적화된 정적 파일을 생성 후 FastAPI 서버에서 제공:

```bash
# 빌드 모드 실행
python run.py build

# 의존성 설치 건너뛰기
python run.py build --no-install

# UI 서버 포트 지정
python run.py build --ui-port 3001
```

### 3. 접속 정보

#### 개발 모드 (dev)
- **프론트엔드**: `http://localhost:5173` (자동으로 브라우저에서 열림)
- **백엔드 API**: `http://localhost:8000`
- **API 문서**: `http://localhost:8000/docs`

#### 프로덕션 모드 (build)
- **통합 애플리케이션**: `http://localhost:8000`
- **API 문서**: `http://localhost:8000/docs`

## 📁 프로젝트 구조

### 🌳 전체 구조 개요
```
autolabeling/
├── 📁 src/                          # Vue.js 프론트엔드
│   ├── 📁 components/               # Vue 컴포넌트
│   │   ├── 📁 dialogs/             # 다이얼로그 컴포넌트
│   │   ├── 📁 images/              # 이미지 뷰어 컴포넌트
│   │   ├── 📁 models/              # 모델 관리 컴포넌트
│   │   ├── 📁 projects/            # 프로젝트 관리 컴포넌트
│   │   ├── 📁 sidebar/             # 사이드바 컴포넌트
│   │   └── 📁 ui/                  # UI 공통 컴포넌트
│   ├── 📁 api/                     # API 호출 함수
│   ├── 📁 assets/                  # 정적 자원
│   ├── 📁 composables/             # Vue 컴포저블
│   ├── 📁 config/                  # 설정 파일
│   ├── 📁 services/                # 비즈니스 로직 서비스
│   │   └── 📁 labeling/            # 라벨링 서비스
│   ├── 📁 utils/                   # 유틸리티 함수
│   ├── 📁 views/                   # 페이지 컴포넌트
│   ├── 📄 main.js                  # Vue 앱 진입점
│   └── 📄 App.vue                  # 루트 Vue 컴포넌트
├── 📁 server/                       # FastAPI 백엔드
│   ├── 📁 api/                     # API 라우터들
│   ├── 📁 core/                    # 핵심 설정 및 유틸리티
│   ├── 📁 managers/                # 도메인별 매니저 클래스
│   ├── 📁 services/                # 비즈니스 로직
│   ├── 📁 uploaded_images/         # 업로드된 이미지 저장소
│   └── 📄 main.py                  # FastAPI 서버 메인
├── 📁 public/                       # 정적 파일
├── 📁 scripts/                      # 스크립트 파일
├── 📁 imgs/                         # 문서용 이미지
├── 📄 package.json                 # Node.js 의존성
├── 📄 Pipfile                      # Python 의존성
├── 📄 vite.config.js              # Vite 설정
├── 📄 index.html                   # HTML 엔트리 포인트
└── 📄 run.py                      # 통합 실행 스크립트
```

## 🔧 환경 설정

### 환경 변수 설정

#### 1. 환경 변수 파일 생성

```bash
# 예제 파일 복사
cp env.example .env.local
```

#### 2. 주요 환경 변수

| 변수명 | 설명 | 기본값 |
|--------|------|--------|
| `VITE_API_SERVER` | API 서버 주소 | 자동 감지 |
| `VITE_CURRENT_USER` | 현재 사용자명 | `thub` |
| `AUTOLABELING_UPLOAD_DIR` | 업로드 디렉토리 (최우선) | - |
| `AUTOLABELING_DATA_DIR` | 데이터 디렉토리 | - |

#### 3. 설정 방법

```bash
# .env.local 파일 생성
cat > .env.local << EOF
VITE_CURRENT_USER=your_username
AUTOLABELING_UPLOAD_DIR=/home/your_username/autolabeling/server/uploaded_images
EOF
```

## ⌨️ 키보드 단축키

### 🎯 편집 및 조작

| 키 | 기능 | 모드 | 설명 |
|---|------|------|------|
| **E** | 편집 모드 활성화 | 모든 모드 | 바운딩 박스 편집 및 생성 모드 진입 |
| **R** | 편집 모드 해제 | 편집 모드 | 편집 모드에서 일반 보기 모드로 전환 |
| **B** | 바운딩 박스 그리기 | 편집 모드만 | 마우스 드래그로 새 바운딩 박스 그리기 |
| **T** | 변경사항 저장 | 보기 모드만 | 현재 이미지의 바운딩 박스 변경사항 저장 |

### 🎮 복사 및 편집

| 키 | 기능 | 모드 | 설명 |
|---|------|------|------|
| **Ctrl+C** | 바운딩 박스 복사 | 모든 모드 | 선택된 바운딩 박스 복사 |
| **Ctrl+V** | 바운딩 박스 붙여넣기 | 편집 모드만 | 마우스 위치에 복사된 박스 붙여넣기 |
| **Ctrl+Z** | 작업 되돌리기 | 편집 모드 | 최대 10단계 히스토리 복원 |
| **A** | 전체복사 | 편집 모드만 | 모든 바운딩 박스 복사 |
| **D** | 바운딩 박스 삭제 | 편집 모드만 | 선택된 바운딩 박스 삭제 |

### 🔍 표시 및 네비게이션

| 키 | 기능 | 모드 | 설명 |
|---|------|------|------|
| **H** | 바운딩 박스 숨김/표시 | 편집 모드만 | 선택된 박스 토글 |
| **G** | 숨겨진 박스 모두 표시 | 편집 모드만 | 모든 숨겨진 바운딩 박스 표시 |
| **N** | 바운딩 박스 굵기 토글 | 편집 모드만 | 굵게/얇게 전환 (이미지 변경 시에도 유지) |
| **←/→** | 이미지 이동 | 모든 모드 | 이전/다음 이미지로 전환 |
| **S/F** | 이미지 이동 | 모든 모드 | 이전(S)/다음(F) 이미지로 전환 |

### 🖱️ 마우스 조작

| 조작 | 기능 | 모드 | 설명 |
|------|------|------|------|
| **Space + 드래그** | 이미지 이동 | 모든 모드 | 언제든지 이미지 위치 조정 |
| **마우스 휠 ↑** | 확대 | 모든 모드 | 마우스 포인터 중심으로 확대 |
| **마우스 휠 ↓** | 축소 | 모든 모드 | 마우스 포인터 중심으로 축소 |
| **Shift + 클릭** | 다중 선택 | 편집 모드만 | 여러 바운딩 박스 선택/해제 |

### 🔍 확대/축소 단축키

| 키 | 기능 | 설명 |
|---|------|------|
| **W** | 단계적 확대 | 마우스 커서 중심으로 단계적 확대 (25%-1600% 순환) |
| **Q** | 단계적 축소 | 마우스 커서 중심으로 단계적 축소 (1600%-25% 순환) |

### 🎯 기타

| 키 | 기능 | 설명 |
|---|------|------|
| **0-9** | 클래스 선택 | 숫자 키로 클래스 직접 선택 |
| **P** | 프로젝트 불러오기 | 프로젝트 로드 다이얼로그 열기 |
| **DELETE** | 파일 삭제 | 현재 이미지 파일 및 라벨 파일 삭제 |
| **`** | 단축키 도움말 | 키보드 단축키 가이드 표시 |
| **M** | 이미지 중앙 정렬 | 이미지를 화면 중앙으로 이동 |

## 📖 API 문서

### 주요 엔드포인트

#### 🖼️ 이미지 관리
```http
POST /api/upload-images        # 이미지 업로드
GET  /files/{filename}         # 이미지 파일 서빙
DELETE /api/delete-image/{filename} # 이미지 및 라벨 파일 삭제
```

#### 🤖 모델 관리
```http
GET  /models/                  # 모델 목록 조회
POST /models/load/{model_path} # 모델 로드
GET  /model/classes           # 모델 클래스 정보
GET  /model/classes-with-ids  # 클래스 정보 (ID 포함)
DELETE /models/{model_type}/{model_name} # 모델 파일 삭제
```

#### 🏷️ 라벨링
```http
POST /labeling/process        # 자동 라벨링 수행
POST /model/predict/{filename} # 단일 이미지 예측
```

#### 💾 프로젝트 관리
```http
POST /api/project/save-local   # 프로젝트 저장
POST /api/load-project         # 프로젝트 로드
GET  /api/list-projects        # 프로젝트 목록 조회
POST /api/save-class-file      # 클래스 파일 저장
POST /api/save-label-file      # 라벨 파일 저장
```

### API 문서 확인

서버 실행 후 다음 URL에서 상세한 API 문서를 확인할 수 있습니다:

- **Swagger UI**: `http://localhost:8000/docs`
- **ReDoc**: `http://localhost:8000/redoc`

## 💾 프로젝트 저장 형식

### 프로젝트 구조

```
project_name/
├── 📁 images/              # 원본 이미지 파일
│   ├── image001.jpg
│   └── ...
├── 📁 labels/              # YOLO 형식 라벨 파일
│   ├── image001.txt        # 클래스별 바운딩 박스 정보
│   └── ...
├── 📄 project_info.json   # 프로젝트 메타데이터
```

### 프로젝트 정보 파일 (project_info.json)

```json
{
  "projectName": "safety_detection",
  "datetime": "2025-01-10 10:30:00",
  "totalImages": 150,
  "savedImages": 150,
  "savedLabels": 150,
  "class_info": [
    {"id": 0, "name": "person"},
    {"id": 1, "name": "helmet"},
    {"id": 2, "name": "safety_vest"}
  ],
  "lowConfidenceImages": [
    {
      "filename": "image_042.jpg",
      "confidence": "23%"
    }
  ]
}
```

### YOLO 라벨 파일 (.txt)

```
# class_id x_center y_center width height (모든 값은 0~1로 정규화)
0 0.512345 0.423567 0.234567 0.345678  # person
1 0.789012 0.567890 0.123456 0.234567  # helmet
```

**🔥 개선된 클래스 정보 처리**:
- 모델의 원래 클래스 ID 순서 완벽 보장
- 프로젝트 저장 시 클래스 정보 무결성 확보
- 프로젝트 로드 시 클래스 매핑 정확성 향상

## 🔍 트러블슈팅

### 일반적인 문제

#### 1. 서버 시작 오류
```bash
# 포트 8000이 이미 사용 중인 경우
python run.py --port 8001

# 또는 직접 포트 종료
lsof -ti:8000 | xargs kill -9
```

#### 2. 의존성 문제
```bash
# 프론트엔드 의존성
npm install

# 백엔드 의존성
pip install -r requirements.txt
```

#### 3. 캐시 문제
```bash
# 빌드 캐시 정리
rm -rf node_modules/.vite
rm -rf dist/

# 다시 빌드
python run.py build
```

#### 4. 편집 모드에서 이미지가 움직이지 않는 경우
- **해결방법**: **Space 키를 누르고** 드래그하여 이미지 이동

#### 5. 바운딩 박스 편집 문제
- **해결방법**: 편집 모드(E키)에서 바운딩 박스 선택 후 드래그 또는 핸들 조작

#### 6. 파일 삭제 관련 문제
- **DELETE키가 작동하지 않는 경우**: 프로젝트가 로드되어 있고 이미지가 표시된 상태에서만 사용 가능
- **삭제 확인 다이얼로그가 나타나지 않는 경우**: 다른 다이얼로그가 열려있는지 확인하고 닫은 후 다시 시도
- **파일 삭제 실패**: 파일이 다른 프로그램에서 사용 중이거나 권한이 없는 경우 발생

#### 7. DELETE 요청 오류
- **HTTP 501 오류**: 이전 버전에서 DELETE 요청이 지원되지 않아 발생하는 오류
- **해결방법**: 최신 버전의 `run.py` 사용으로 DELETE 요청 프록시 기능 지원
- **API 호환성**: 모든 HTTP 메소드(GET, POST, PUT, DELETE, OPTIONS) 완전 지원
- **백엔드 연동**: DELETE 요청이 FastAPI 백엔드로 정상 프록시됨

#### 8. 모델 로드 문제
- **모델 클래스 정보를 가져올 수 없는 경우**: 먼저 YOLO 모델을 올바르게 로드했는지 확인
- **클래스 ID 매핑 오류**: 프로젝트 저장/로드 시 모델이 먼저 로드되어 있어야 함
- **모델 상태 검증 실패**: 모델 파일이 손상되었거나 지원하지 않는 형식인 경우

#### 9. 프로젝트 저장/로드 문제
- **프로젝트 저장 실패**: 모델이 로드되어 있는지 확인
- **클래스 정보 누락**: 프로젝트 파일의 class_info 키 확인
- **라벨 파일 형식 오류**: YOLO 형식 호환성 검증

#### 10. 바운딩박스 복사/붙여넣기 문제
- **Ctrl+V가 작동하지 않는 경우**: 복사된 바운딩박스가 있는지 확인
- **"복사된 바운딩박스가 없습니다" 메시지**: 먼저 Ctrl+C 또는 A키로 바운딩박스 복사
- **붙여넣기 시 박스가 잘못된 위치에 생성**: 마우스가 이미지 영역 위에 있는지 확인
- **이미지 변경 시 복사 데이터 손실**: 최신 버전에서는 이미지 변경 시에도 복사 데이터 유지됨

#### 11. 바운딩박스 굵기 설정 문제
- **T키로 설정한 굵기가 다른 이미지에서 유지되지 않는 경우**: 최신 버전에서는 굵기 설정이 이미지 변경 시에도 유지됨
- **굵기 설정이 적용되지 않는 경우**: 편집 모드(E키)에서만 T키 사용 가능
- **굵기 설정 초기화**: 프로그램 재시작 시 굵기 설정은 기본값으로 초기화됨

#### 13. YOLO 모델 파라미터 최적화 문제
- **신뢰도 설정이 적용되지 않는 경우**: 사이드바에서 설정한 신뢰도 값이 모델에 정확히 반영됨
- **hoist, helmet 검출 성능 저하**: 최적화된 NMS IoU 임계값(0.5)과 사용자 신뢰도 설정으로 검출 성능 향상
- **400 Bad Request 오류**: 상세한 로깅 시스템으로 정확한 오류 원인 파악 가능
  - 파일 읽기, 이미지 처리, 모델 예측, 결과 처리 각 단계별 로그 확인
  - 서버 로그에서 구체적인 오류 위치 및 원인 확인 가능
- **모델 예측 투명성**: 각 처리 단계별 성공/실패 로그로 디버깅 효율성 향상

#### 12. 클래스 범례 표시 문제
- **클래스 범례가 표시되지 않는 경우**: 프로젝트가 로드되어 있고 class_info가 있는지 확인
- **범례가 빈 상태로 표시**: 모델이 먼저 로드되어야 클래스 정보를 가져올 수 있음
- **클래스 색상이 일치하지 않는 경우**: 바운딩박스 색상과 범례 색상은 동일한 색상 시스템 사용
- **범례 위치 조정**: 이미지 뷰어 좌측 상단에 고정되어 있으며, 편집 모드 인디케이터와 겹치지 않음
- **많은 클래스로 인한 범례 오버플로우**: 범례 컨테이너는 최대 높이 200px로 제한되며 스크롤 가능

### 성능 최적화

#### 1. YOLO 모델 예측 최적화
- **사용자 맞춤 신뢰도 적용**: 사이드바 설정값이 정확히 모델에 반영되어 원하는 검출 수준 달성
- **최적화된 NMS 설정**: IoU 임계값 0.5로 중복 제거와 검출 성능 균형 최적화
- **ultralytics 표준 파라미터**: 검증된 기본값들로 안정적이고 일관된 예측 성능
- **상세 로깅 시스템**: 처리 과정 투명성으로 성능 병목 지점 식별 가능

#### 2. 메모리 기반 처리
- 임시 파일 저장 제거로 디스크 I/O 최소화
- 자동 메모리 정리 시스템 구현
- **메모리 사용량 최적화**: 불필요한 객체 참조 제거

#### 3. 저해상도 이미지 자동 최적화
- 640px 미만 이미지 자동 리사이즈
- 매우 낮은 해상도(300px 미만) 특별 처리

#### 4. 코드 최적화
- **Import 최적화**: 시작 시간 단축
- **함수 호출 최적화**: 불필요한 메서드 호출 제거
- **정규표현식 최적화**: 파일 패턴 매칭 성능 향상
- **타입 검증 개선**: 런타임 오류 방지

## 🎯 사용법

### 1️⃣ 기본 사용법
1. **프로그램 실행**: `python run.py`로 서버 시작
2. **YOLO 모델 로드**: 먼저 모델을 로드하여 클래스 정보 확보
3. **신뢰도 설정**: 사이드바에서 원하는 신뢰도 임계값 설정 (설정값이 정확히 모델에 적용됨)
4. **이미지 업로드**: 드래그 앤 드롭 또는 파일 선택으로 이미지 업로드
5. **자동 라벨링 실행**: 최적화된 YOLO 파라미터로 객체 탐지 및 바운딩 박스 생성
6. **클래스 범례 확인**: 이미지 뷰어 좌측 상단에서 클래스 ID, 이름, 색상 정보 확인
7. **결과 검토 및 편집**: E키로 편집 모드 진입 후 바운딩 박스 수정
8. **저장**: R키로 편집 모드 해제 후 T키로 저장
9. **프로젝트 저장**: 전체 프로젝트를 압축 파일로 다운로드

### 2️⃣ 효율적인 편집 방법
1. **E키로 편집모드 진입**
2. **바운딩 박스 편집**: 클릭하여 선택 후 드래그로 이동, 핸들로 크기 조정
3. **다중 선택**: Shift+클릭으로 여러 박스 선택
4. **복사/붙여넣기**: Ctrl+C/V로 바운딩 박스 복사 (이미지 변경 시에도 유지)
5. **전체 복사**: A키로 모든 바운딩 박스 복사
6. **바운딩 박스 굵기 설정**: T키로 굵기 토글 (이미지 변경 시에도 유지)
7. **R키로 편집모드 해제** 후 **T키로 저장**

### 3️⃣ 프로그레스 바 네비게이션
- **클릭 이동**: 프로그레스 바 원하는 위치 클릭으로 해당 이미지로 이동
- **드래그 이동**: 원형 마커를 드래그하여 실시간 이미지 탐색

### 4️⃣ 확대/축소 기능
- **마우스 휠**: 마우스 커서 위치를 중심으로 부드러운 확대/축소
- **W키 (확대)**: 마우스 커서 중심으로 단계적 확대 (25%-1600% 순환)
- **Q키 (축소)**: 마우스 커서 중심으로 단계적 축소 (1600%-25% 순환)
- **정밀 탐색**: 마우스 위치 기반 확대/축소로 원하는 부분을 정확히 확대하여 편집

### 5️⃣ 파일 삭제 기능
- **DELETE키 누르기**: 현재 이미지에서 DELETE키를 누르면 삭제 확인 다이얼로그 표시
- **확인 다이얼로그**: 삭제할 이미지 파일과 라벨 파일을 미리 확인
- **안전 삭제**: 실수 방지를 위해 확인 버튼을 눌러야 삭제 실행
- **자동 정리**: 삭제 후 이미지 목록에서 자동으로 제거되고 다음 이미지로 이동

### 6️⃣ 프로젝트 관리 모범 사례
- **모델 우선 로드**: 프로젝트 작업 전 반드시 YOLO 모델을 먼저 로드
- **클래스 정보 확인**: 사이드바에서 로드된 모델의 클래스 정보 확인
- **정기적 저장**: 작업 중 중간중간 프로젝트 저장으로 데이터 손실 방지
- **프로젝트 구조 확인**: 저장된 프로젝트의 images, labels 폴더 구조 확인

## 🤝 기여하기

### 개발 환경 설정

1. **저장소 클론**
```bash
git clone <repository-url>
cd autolabeling
```

2. **의존성 설치**
```bash
# 자동 의존성 설치 (권장)
python run.py dev

# 또는 수동 설치
npm install
pip install -r requirements.txt
```

3. **개발 서버 실행**
```bash
# 통합 개발 서버 (권장)
python run.py dev

# 또는 분리 실행
npm run dev          # Frontend (포트 5173)
cd server && python main.py  # Backend (포트 8000)
```

### 코드 품질 가이드라인

#### Python (Backend)
- **Linter 오류 없음**: 모든 Python 파일에서 linter 오류 해결 필수 ✅
- **타입 힌트 사용**: 함수 매개변수 및 반환값에 타입 힌트 추가
- **불필요한 import 제거**: 사용하지 않는 라이브러리 import 삭제 ✅
- **함수 중복 방지**: 기능이 중복되는 함수는 통합하여 코드 일관성 유지 ✅
- **예외 처리 개선**: `except:` 대신 `except Exception:` 사용 ✅
- **사용하지 않는 변수 제거**: 변수명을 `_` 로 변경하여 의도를 명확히 ✅

#### JavaScript/Vue (Frontend)
- **ESLint 규칙 준수**: 모든 JavaScript/Vue 파일에서 ESLint 규칙 준수
- **Prettier 포맷팅**: 코드 포맷팅 자동화로 일관된 코드 스타일 유지
- **컴포넌트 분리**: 재사용 가능한 컴포넌트로 분리하여 모듈화

#### 서버 개발
- **HTTP 메소드 완전 지원**: GET, POST, PUT, DELETE, OPTIONS 모두 프록시 처리 ✅
- **타입 안전성**: TypeScript 수준의 타입 검증 구현 ✅
- **에러 핸들링**: 각 HTTP 메소드별 적절한 에러 응답 처리 ✅
- **CORS 지원**: 모든 HTTP 메소드에 대한 CORS 헤더 설정 ✅

### 주요 개선 방향

- **UI/UX 개선**: 라이트 테마, 반응형 디자인 개선, 클래스 범례 기능 확장
- **성능 최적화**: 비동기 처리, 캐싱 시스템 도입, 메모리 사용량 최적화
- **기능 확장**: 프로젝트 검색/필터링, 배치 처리, 범례 커스터마이징
- **테스트 강화**: 단위 테스트 및 통합 테스트 확대
- **코드 품질**: 지속적인 리팩토링 및 최적화

---

**🎉 Happy Labeling! 🏷️**

*Vue.js 3 + Konva 기반 고성능 이미지 라벨링 도구*  
*YOLO 모델 파라미터 최적화로 hoist, helmet 등 산업 안전 장비 검출 성능 대폭 향상*  
*사용자 맞춤 신뢰도 설정과 최적화된 NMS로 정확하고 유연한 객체 탐지*  
*상세한 로깅 시스템과 예외 처리 개선으로 안정적이고 투명한 라벨링 환경*
# AutoLabeling_Tool-.ver2-
